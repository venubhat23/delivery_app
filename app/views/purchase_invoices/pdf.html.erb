<% content_for :title, "Purchase Invoice ##{@purchase_invoice.invoice_number}" %>

<!-- Just show the content as it appears in preview -->
<div class="content">
  <%= raw @purchase_invoice.content if @purchase_invoice.respond_to?(:content) && @purchase_invoice.content.present? %>
  
  <!-- If there's no content field, show basic invoice info -->
  <% unless @purchase_invoice.respond_to?(:content) && @purchase_invoice.content.present? %>
    <p><strong>Invoice #:</strong> <%= @purchase_invoice.invoice_number %></p>
    <p><strong>Date:</strong> <%= @purchase_invoice.invoice_date.strftime('%d/%m/%Y') %></p>
    <p><strong>Supplier:</strong> <%= @purchase_invoice.supplier_name %></p>
    
    <% if @purchase_invoice.purchase_invoice_items.present? %>
      <table>
        <thead>
          <tr>
            <th>Item</th>
            <th>Quantity</th>
            <th>Rate</th>
            <th>Amount</th>
          </tr>
        </thead>
        <tbody>
          <% @purchase_invoice.purchase_invoice_items.each do |item| %>
            <tr>
              <td><%= item.purchase_product.name %></td>
              <td><%= item.quantity %></td>
              <td class="amount">₹ <%= number_with_delimiter(item.unit_price) %></td>
              <td class="amount">₹ <%= number_with_delimiter(item.total_price) %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
      
      <p><strong>Total: ₹ <%= number_with_delimiter(@purchase_invoice.total_amount) %></strong></p>
    <% end %>
  <% end %>
</div>

<div class="footer-spacing"></div>

<style>
  .content {
    margin-bottom: 20px;
  }
  
  table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 20px;
    font-size: 11pt;
  }

  table th,
  table td {
    border: 1px solid #333;
    padding: 8px;
    text-align: left;
  }

  table th {
    background-color: #f5f5f5;
    font-weight: bold;
    text-align: center;
  }

  table td.amount {
    text-align: right;
  }
</style>