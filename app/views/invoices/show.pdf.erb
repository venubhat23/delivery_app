<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Invoice #<%= @invoice.id %></title>
    <style>
      @page {
        size: A4;
        margin: 2cm;
        margin-bottom: 3cm;
      }
      
      body {
        font-family: 'Arial', sans-serif;
        font-size: 12pt;
        line-height: 1.6;
        color: #333;
        margin: 0;
        padding: 0;
        position: relative;
      }

      /* Diagonal watermark */
      .watermark {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) rotate(-45deg);
        font-size: 72px;
        font-weight: bold;
        color: rgba(0, 0, 0, 0.1);
        z-index: -1;
        pointer-events: none;
        white-space: nowrap;
      }

      .page-break {
        page-break-before: always;
      }

      .footer-spacing {
        height: 5cm;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
        font-size: 11pt;
      }

      table th,
      table td {
        border: 1px solid #333;
        padding: 8px;
        text-align: left;
      }

      table th {
        background-color: #f5f5f5;
        font-weight: bold;
        text-align: center;
      }

      table td.amount {
        text-align: right;
      }

      .content {
        margin-bottom: 20px;
      }
    </style>
  </head>
  <body>
    <!-- Diagonal watermark -->
    <div class="watermark">Atma Nirbhar Farm</div>

    <!-- Just show the content as it appears in preview -->
    <div class="content">
      <%= raw @invoice.content if @invoice.respond_to?(:content) && @invoice.content.present? %>
      
      <!-- If there's no content field, show basic invoice info -->
      <% unless @invoice.respond_to?(:content) && @invoice.content.present? %>
        <p><strong>Invoice #:</strong> <%= @invoice.id %></p>
        <p><strong>Date:</strong> <%= @invoice.invoice_date.strftime('%d/%m/%Y') %></p>
        <p><strong>Customer:</strong> <%= @customer.name %></p>
        
        <% if @invoice_items.present? %>
          <table>
            <thead>
              <tr>
                <th>Item</th>
                <th>Quantity</th>
                <th>Rate</th>
                <th>Amount</th>
              </tr>
            </thead>
            <tbody>
              <% @invoice_items.each do |item| %>
                <tr>
                  <td><%= item.product.name %></td>
                  <td><%= item.quantity %></td>
                  <td class="amount">₹ <%= number_with_delimiter(item.unit_price) %></td>
                  <td class="amount">₹ <%= number_with_delimiter(item.total_price) %></td>
                </tr>
              <% end %>
            </tbody>
          </table>
          
          <p><strong>Total: ₹ <%= number_with_delimiter(@invoice.total_amount) %></strong></p>
        <% end %>
      <% end %>
    </div>

    <div class="footer-spacing"></div>
  </body>
</html>
